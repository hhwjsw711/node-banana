---
phase: 12-model-improvements
plan: 01
type: execute
---

<objective>
Extend model cache TTL and verify Replicate image models work end-to-end.

Purpose: Reduce API calls with longer cache duration and confirm Replicate image generation functions correctly.
Output: Updated cache configuration and verified working Replicate image generation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Key files:
@src/lib/providers/cache.ts

# Prior context:
Model cache currently uses 10-minute TTL. Models don't change frequently, so longer TTL reduces API calls.
Replicate image generation implemented in Phase 2-3, needs end-to-end verification.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend model cache TTL to 1 hour</name>
  <files>src/lib/providers/cache.ts</files>
  <action>Change DEFAULT_TTL from 10 minutes (10 * 60 * 1000) to 1 hour (60 * 60 * 1000). Update the comment to reflect "1 hour" instead of "10 minutes". This reduces API calls to provider model listing endpoints.</action>
  <verify>grep "DEFAULT_TTL" src/lib/providers/cache.ts shows 60 * 60 * 1000</verify>
  <done>Cache TTL is 1 hour (3,600,000 ms)</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Extended cache TTL configuration</what-built>
  <how-to-verify>
    1. Start dev server: npm run dev
    2. Open http://localhost:3000
    3. Configure a Replicate API key in Settings if not already done
    4. Click the Replicate icon in the floating action bar to open model search
    5. Search for "flux" and select a text-to-image model (e.g., "black-forest-labs/flux-schnell")
    6. Add a prompt like "a mountain landscape at sunset"
    7. Click Run (Cmd+Enter) to generate an image
    8. Confirm: Image appears in the output node
    9. Confirm: No errors in console or UI
  </how-to-verify>
  <resume-signal>Type "approved" if Replicate image generation works, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] Cache TTL is set to 1 hour
- [ ] Replicate image model generates successfully (human verified)
</verification>

<success_criteria>

- Cache TTL extended to 1 hour
- Replicate image generation verified working
- Build passes
- Phase 12 complete
</success_criteria>

<output>
After completion, create `.planning/phases/12-model-improvements/12-01-SUMMARY.md`:

# Phase 12-01: Model Improvements Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase complete, ready for milestone v1.1 completion.
</output>
